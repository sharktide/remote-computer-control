<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Electron Receiver</title>
</head>
<body>
  <h1>Welcome to serial data receiver</h1>
  
  <h3>Select COM Port:</h3>
  <select id="com-port">
    <option value="">-- Select COM Port --</option>
  </select>

  <h3>Enter Baud Rate:</h3>
  <input type="number" id="baud-rate" placeholder="Enter Baud Rate" value="9600">

  <button onclick="connectSerial()">Connect</button>

  <h3>Command Input:</h3>
  <input type="text" id="command" placeholder="Enter command">
  <button onclick="sendCommand()">Send Command</button>

  <h3>Serial Data Output:</h3>
  <pre id="output"></pre>

  <script>
    const { ipcRenderer } = require('electron');

    // Populate the COM port dropdown
    ipcRenderer.on('available-ports', (event, ports) => {
      const comPortSelect = document.getElementById('com-port');
      ports.forEach(port => {
        const option = document.createElement('option');
        option.value = port;
        option.textContent = port;
        comPortSelect.appendChild(option);
      });
    });

    // Handle connection to serial port
    function connectSerial() {
      const comPort = document.getElementById('com-port').value;
      const baudRate = parseInt(document.getElementById('baud-rate').value, 10);
      if (comPort && baudRate) {
        ipcRenderer.send('connect-serial', { comPort, baudRate });
      } else {
        alert('Please select a COM port and enter a baud rate.');
      }
    }

    // Send a command to the serial port
    function sendCommand() {
      const command = document.getElementById('command').value;
      ipcRenderer.send('send-command', command);
    }

    // Listen for incoming serial data
    ipcRenderer.on('serial-data', (event, data) => {
      const output = document.getElementById('output');
      output.textContent += `\n${data}`;
    });
  </script>
</body>
</html>
